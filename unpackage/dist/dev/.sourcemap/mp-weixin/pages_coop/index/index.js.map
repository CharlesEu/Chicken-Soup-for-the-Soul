{"version":3,"file":"index.js","sources":["pages_coop/index/index.vue","../前端资料/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNfY29vcFxpbmRleFxpbmRleC52dWU"],"sourcesContent":["<template>\t\n\t<view class=\"layout\">\n\t\t<z-paging ref=\"paging\" v-model=\"coopData\" @query=\"queryList\" :default-page-size=\"10\" empty-view-text=\"暂无数据\">\n\t\t\t <template #loading>\n\t\t\t \t<uni-load-more status=\"loading\"></uni-load-more>\n\t\t\t </template>\n\t\t\t \n\t\t\t <view class=\"list\" v-if=\"coopData.length\">\n\t\t\t\t<view class=\"item\" v-for=\"item in coopData\" :key=\"item._id\">\t\t\t\t\t\n\t\t\t\t\t<coop-item :item=\"item\" @delRowEnv=\"delRowEnv\" v-if=\"!item.ad\"></coop-item>\t\t\n\t\t\t\t\t\t\t\t \n\t\t\t\t\t<view v-else class=\"wxAd\" style=\"padding:0 18rpx\">\n\t\t\t\t\t\t<!-- #ifdef MP-WEIXIN -->\t\t\t\t\t\t\n\t\t\t\t\t\t<ad unit-id=\"adunit-3e2ae9dacbcb600d\" ad-type=\"video\" ad-theme=\"white\"></ad>\n\t\t\t\t\t\t<!-- #endif -->\t\t\t\t\t\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t </view>\t\t\t \n\t\t</z-paging>\n\t\t\n\t\t<uni-fab ref=\"fab\" :pattern=\"{icon:'compose'}\" horizontal=\"right\" vertical=\"bottom\" \n\t\t@fabClick=\"goAdd\"/>\n\t</view>\t\n</template>\n\n<script setup>\nimport {ref,nextTick, onMounted,defineExpose,computed} from \"vue\";\nconst db = uniCloud.database();\nconst dbCmd = db.command;\nconst coopData = ref([]);\nconst paging = ref(null);\n\n//获取圈子列表\nasync function queryList(pageNo, pageSize){\n\tlet skip = (pageNo-1)*pageSize;\t\n\tlet coopTemp = db.collection(\"chicken-coop\").where({\n\t\tis_delete:dbCmd.neq(true),\n\t\tstatus:1\n\t}).getTemp();\n\tlet userTemp = await db.collection(\"uni-id-users\").field(\"_id,username,avatar\").getTemp();\t\n\tlet {result:{errCode,data}} = \n\tawait db.collection(coopTemp,userTemp).field(\"arrayElemAt(user_id,0) as userInfo,content,picurls,is_delete,publish_ip,publish_date,status,publish_address\").orderBy(\"publish_date\",\"desc\").skip(skip).limit(pageSize).get();\t\n\tdata.forEach(item=>{\t\t\n\t\titem.picurls = item.picurls.map(pic=>pic+'?imageMogr2/thumbnail/200x')\t\t\t\n\t})\n\tif(data.length>5) data.splice(5,0,{ad:true});\n\tconsole.log(data);\n\tpaging.value.complete(data);\n}\n\n\nconst goAdd = ()=>{\n\tuni.navigateTo({\n\t\turl:'/pages_coop/write/add'\n\t})\n}\n\nconst delRowEnv = ()=>{\n\tpaging.value.refresh();\n}\n\n\n\n</script>\n\n<style lang=\"scss\" scoped>\n.layout{\n\t.item{\n\t\tborder-bottom:18rpx solid #f8f8f8;\n\t\t&:last-child{\n\t\t\tborder:none;\n\t\t\tmargin-bottom:60rpx;\n\t\t}\n\t}\n}\n</style>\n","import MiniProgramPage from 'C:/Users/DELL/Desktop/chickensoup/pages_coop/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","ref","uni"],"mappings":";;;;;;;;;;;;;;;;;;;AA2BA,UAAM,KAAKA,cAAAA,GAAS;AACpB,UAAM,QAAQ,GAAG;AACjB,UAAM,WAAWC,cAAAA,IAAI,CAAA,CAAE;AACvB,UAAM,SAASA,cAAAA,IAAI,IAAI;AAGvB,mBAAe,UAAU,QAAQ,UAAS;AACzC,UAAI,QAAQ,SAAO,KAAG;AACtB,UAAI,WAAW,GAAG,WAAW,cAAc,EAAE,MAAM;AAAA,QAClD,WAAU,MAAM,IAAI,IAAI;AAAA,QACxB,QAAO;AAAA,MACT,CAAE,EAAE,QAAO;AACV,UAAI,WAAW,MAAM,GAAG,WAAW,cAAc,EAAE,MAAM,qBAAqB,EAAE;AAChF,UAAI,EAAC,QAAO,EAAC,SAAQ,KAAI,EAAC,IAC1B,MAAM,GAAG,WAAW,UAAS,QAAQ,EAAE,MAAM,6GAA6G,EAAE,QAAQ,gBAAe,MAAM,EAAE,KAAK,IAAI,EAAE,MAAM,QAAQ,EAAE;AACtN,WAAK,QAAQ,UAAM;AAClB,aAAK,UAAU,KAAK,QAAQ,IAAI,SAAK,MAAI,4BAA4B;AAAA,MACvE,CAAE;AACD,UAAG,KAAK,SAAO;AAAG,aAAK,OAAO,GAAE,GAAE,EAAC,IAAG,KAAI,CAAC;AAC3CC,oBAAAA,uDAAY,IAAI;AAChB,aAAO,MAAM,SAAS,IAAI;AAAA,IAC3B;AAGA,UAAM,QAAQ,MAAI;AACjBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAI;AAAA,MACN,CAAE;AAAA,IACF;AAEA,UAAM,YAAY,MAAI;AACrB,aAAO,MAAM;IACd;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1DA,GAAG,WAAW,eAAe;"}