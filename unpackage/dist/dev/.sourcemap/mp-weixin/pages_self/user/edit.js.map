{"version":3,"file":"edit.js","sources":["pages_self/user/edit.vue","../前端资料/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNfc2VsZlx1c2VyXGVkaXQudnVl"],"sourcesContent":["<template>\n\t<view class=\"userLayout\">\n\t\t<view class=\"avatar\">\n\t\t\t<view class=\"box\">\n\t\t\t\t<view class=\"inner\">\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t<image v-if=\"avatarUrl\" :src=\"avatarUrl\" mode=\"aspectFill\"></image>\n\t\t\t\t\t<image v-else src=\"../../static/images/defAvatar.png\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t<button open-type=\"chooseAvatar\" @chooseavatar=\"onChooseAvatar\" class=\"btn\">按钮</button>\n\t\t\t\t\t<view class=\"mask\" v-if=\"uploadState\">\n\t\t\t\t\t\t上传{{percentCompleted}}%\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"icon\">\n\t\t\t\t\t<uni-icons type=\"camera\" color=\"#fff\" size=\"16\"></uni-icons>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"text\">点击更换头像</view>\n\t\t\t</view>\n\t\t</view>\t\n\t\t\n\t\t<view class=\"list\">\t\t\t\n\t\t\t<uni-list>\n\t\t\t\t<uni-list-item showArrow title=\"用户ID\" clickable \n\t\t\t\t:rightText=\"userInfo._id\" @click=\"clickID(userInfo._id)\"/>\n\t\t\t\t<uni-list-item showArrow title=\"昵称\" clickable\n\t\t\t\t:rightText=\"userInfo.username\" @click=\"clickUsername\"/>\t\t\t\t\n\t\t\t\t<uni-list-item showArrow title=\"性别\" clickable \n\t\t\t\t:rightText=\"formatGender(userInfo.gender)\"  @click=\"clickGender\"/>\n\t\t\t\t<uni-list-item showArrow title=\"注册时间\"  \n\t\t\t\t:rightText=\"formatDate(userInfo.register_date)\"  @click=\"clickTime\"/>\n\t\t\t</uni-list>\t\t\t \n\t\t</view>\n\t</view>\n\t\n\t<uni-popup ref=\"usernamePopup\" type=\"dialog\">\n\t\t<uni-popup-dialog mode=\"input\" title=\"修改昵称\" maxlength=\"15\" v-model=\"userInfo.username\" placeholder=\"请输入昵称\" @confirm=\"usernameConfirm\">\t\t\t\n\t\t</uni-popup-dialog>\n\t</uni-popup>\n\t\n\t\n\t<uni-popup ref=\"genderPopup\" type=\"dialog\">\n\t\t<uni-popup-dialog  @confirm=\"genderConfirm\" title=\"修改性别\" mode=\"input\">\t\t\n\t\t\t<view class=\"genderForm\">\t\t\t\t\n\t\t\t\t<radio-group @change=\"genderChange\">\n\t\t\t\t\t<label class=\"radio\" v-for=\"item in genderGroup\" :key=\"item.value\">\n\t\t\t\t\t\t<radio :value=\"item.value\" :checked=\"genderValue == item.value\" style=\"transform:scale(0.7)\"/>\n\t\t\t\t\t\t{{item.text}}\n\t\t\t\t\t</label>\t\t\t\t\t\n\t\t\t\t</radio-group>\t\t\t\t\n\t\t\t</view>\n\t\t</uni-popup-dialog>\n\t</uni-popup>\n\t\n</template>\n\n<script setup>\nimport {ref,computed} from \"vue\";\nimport {useUserStore} from \"@/stores/user.js\"\nimport {formatDate,formatGender} from \"@/utils/tools.js\"\nconst userStore = useUserStore();\nconst userInfo = computed(()=>userStore.userInfo);\nconst usernamePopup = ref(null);\nconst genderPopup = ref(null);\nconst genderValue = ref(userStore.userInfo.gender || 0);\nconst avatarUrl = ref(userStore.userInfo.avatar);\nconst uploadState = ref(false);\nconst percentCompleted = ref(0)\nconst genderGroup = ref([\n\t{\n\t\tvalue:0,\n\t\ttext:\"保密\"\n\t},{\n\t\tvalue:1,\n\t\ttext:\"男\"\n\t},{\n\t\tvalue:2,\n\t\ttext:\"女\"\n\t}\n])\n//点击id模块复制内容\nfunction clickID(value){\t\n\tconsole.log(value);\n\tuni.setClipboardData({\n\t\tdata:value,\n\t\tsuccess:res=>{\n\t\t\tconsole.log(res);\n\t\t},\n\t\tfail:err=>{\n\t\t\tconsole.log(err);\n\t\t}\n\t})\n}\n\n//点击获取头像\nfunction onChooseAvatar(e){\n\tuploadState.value = true;\n\tavatarUrl.value = e.detail.avatarUrl;\n\t// 云存储API\n\tuniCloud.uploadFile({\n\t\tfilePath:avatarUrl.value,\n\t\tcloudPath:`userAvatar/${formatDate(Date.now(),\"yyyyMMdd\")}/${Date.now()}.jpg`,\n\t\tcloudPathAsRealPath:true,\n\t\tonUploadProgress: function(progressEvent) {\n\t\t  console.log(progressEvent);\n\t\t  percentCompleted.value = Math.round(\n\t\t\t(progressEvent.loaded * 100) / progressEvent.total\n\t\t  );\n\t\t}\n\t}).then(res=>{\n\t\tavatarUrl.value = res.fileID\n\t\tconsole.log(res.fileID);\n\t\tuserStore.updateUserInfo({avatar:avatarUrl.value})\n\t\tuploadState.value = false;\n\t})\n}\n\n//点击修改昵称\nfunction clickUsername(){\n\tusernamePopup.value.open();\n}\n\n//点击修改性别\nfunction clickGender(){\n\tgenderPopup.value.open();\n}\n\n//点击注册时间\nfunction clickTime(){\n\t\n}\n\n\n//修改性别\nfunction genderChange(e){\n\tconsole.log(e);\t\n\tgenderValue.value = Number(e.detail.value)\n}\n\n//确认修改性别\nfunction genderConfirm(){\t\n\tuni.showLoading();\n\tuserStore.updateUserInfo({gender:genderValue.value})\t\n}\n\n\n//确认修改昵称\nfunction usernameConfirm(e){\t\n\tuni.showLoading();\n\tuserStore.updateUserInfo({username:e})\t\n}\n\n\n</script>\n\n<style lang=\"scss\" scoped>\n.userLayout{\n\t.avatar{\n\t\tpadding:100rpx 0;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\t.box{\n\t\t\theight: 150rpx;\n\t\t\twidth: 150rpx;\n\t\t\tposition: relative;\n\t\t\t.inner{\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\t\t\t\t\n\t\t\t\timage{\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\t\t\t\t\n\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\tborder:1px solid #eee;\n\t\t\t\t}\n\t\t\t\t.btn{\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop:0;\n\t\t\t\t\tleft:0;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\t\n\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\topacity: 0;\n\t\t\t\t}\n\t\t\t\t.mask{\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tbackground: rgba(0,0,0,0.6);\n\t\t\t\t\tcolor:#fff;\n\t\t\t\t\ttop:0;\n\t\t\t\t\tleft:0;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tfont-size: 22rpx;\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t.icon{\n\t\t\t\twidth: 50rpx;\n\t\t\t\theight: 50rpx;\n\t\t\t\tbackground: #FE9468;\n\t\t\t\tborder-radius: 50%;\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: center;\n\t\t\t\talign-items: center;\n\t\t\t\tborder:2px solid #fff;\n\t\t\t\tposition: absolute;\n\t\t\t\tright:0;\n\t\t\t\tbottom:0;\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\t\t\t.text{\n\t\t\t\tfont-size: 25rpx;\n\t\t\t\tcolor:#999;\n\t\t\t\twhite-space: nowrap;\n\t\t\t\tpadding:20rpx 0;\n\t\t\t\ttext-align: center;\n\t\t\t}\n\t\t}\n\t}\n\t.list{\n\t\tpadding:50rpx 0rpx;\t\t\n\t}\n}\n\n.genderForm{\n\t.radio{\n\t\tpadding:0 10rpx;\t\t\n\t}\n}\n\n</style>\n","import MiniProgramPage from 'C:/Users/DELL/Desktop/chickensoup/pages_self/user/edit.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","computed","ref","uni","uniCloud","formatDate"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AA6DA,UAAM,YAAYA,YAAY,aAAA;AAC9B,UAAM,WAAWC,cAAQ,SAAC,MAAI,UAAU,QAAQ;AAChD,UAAM,gBAAgBC,cAAAA,IAAI,IAAI;AAC9B,UAAM,cAAcA,cAAAA,IAAI,IAAI;AAC5B,UAAM,cAAcA,cAAG,IAAC,UAAU,SAAS,UAAU,CAAC;AACtD,UAAM,YAAYA,cAAAA,IAAI,UAAU,SAAS,MAAM;AAC/C,UAAM,cAAcA,cAAAA,IAAI,KAAK;AAC7B,UAAM,mBAAmBA,cAAG,IAAC,CAAC;AAC9B,UAAM,cAAcA,cAAAA,IAAI;AAAA,MACvB;AAAA,QACC,OAAM;AAAA,QACN,MAAK;AAAA,MACP;AAAA,MAAG;AAAA,QACD,OAAM;AAAA,QACN,MAAK;AAAA,MACP;AAAA,MAAG;AAAA,QACD,OAAM;AAAA,QACN,MAAK;AAAA,MACL;AAAA,IACF,CAAC;AAED,aAAS,QAAQ,OAAM;AACtBC,oBAAAA,qDAAY,KAAK;AACjBA,oBAAAA,MAAI,iBAAiB;AAAA,QACpB,MAAK;AAAA,QACL,SAAQ,SAAK;AACZA,wBAAAA,MAAA,MAAA,OAAA,kCAAY,GAAG;AAAA,QACf;AAAA,QACD,MAAK,SAAK;AACTA,wBAAAA,MAAA,MAAA,OAAA,kCAAY,GAAG;AAAA,QACf;AAAA,MACH,CAAE;AAAA,IACF;AAGA,aAAS,eAAe,GAAE;AACzB,kBAAY,QAAQ;AACpB,gBAAU,QAAQ,EAAE,OAAO;AAE3BC,oBAAAA,GAAS,WAAW;AAAA,QACnB,UAAS,UAAU;AAAA,QACnB,WAAU,cAAcC,YAAU,WAAC,KAAK,IAAG,GAAG,UAAU,CAAC,IAAI,KAAK,IAAG,CAAE;AAAA,QACvE,qBAAoB;AAAA,QACpB,kBAAkB,SAAS,eAAe;AACxCF,wBAAAA,sDAAY,aAAa;AACzB,2BAAiB,QAAQ,KAAK;AAAA,YAC9B,cAAc,SAAS,MAAO,cAAc;AAAA,UAChD;AAAA,QACG;AAAA,MACH,CAAE,EAAE,KAAK,SAAK;AACZ,kBAAU,QAAQ,IAAI;AACtBA,sBAAA,MAAA,MAAA,OAAA,mCAAY,IAAI,MAAM;AACtB,kBAAU,eAAe,EAAC,QAAO,UAAU,MAAK,CAAC;AACjD,oBAAY,QAAQ;AAAA,MACtB,CAAE;AAAA,IACF;AAGA,aAAS,gBAAe;AACvB,oBAAc,MAAM;IACrB;AAGA,aAAS,cAAa;AACrB,kBAAY,MAAM;IACnB;AAGA,aAAS,YAAW;AAAA,IAEpB;AAIA,aAAS,aAAa,GAAE;AACvBA,oBAAAA,MAAY,MAAA,OAAA,mCAAA,CAAC;AACb,kBAAY,QAAQ,OAAO,EAAE,OAAO,KAAK;AAAA,IAC1C;AAGA,aAAS,gBAAe;AACvBA,oBAAG,MAAC,YAAW;AACf,gBAAU,eAAe,EAAC,QAAO,YAAY,MAAK,CAAC;AAAA,IACpD;AAIA,aAAS,gBAAgB,GAAE;AAC1BA,oBAAG,MAAC,YAAW;AACf,gBAAU,eAAe,EAAC,UAAS,EAAC,CAAC;AAAA,IACtC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtJA,GAAG,WAAW,eAAe;"}