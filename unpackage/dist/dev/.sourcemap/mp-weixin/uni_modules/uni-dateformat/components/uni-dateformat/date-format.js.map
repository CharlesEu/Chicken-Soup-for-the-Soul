{"version":3,"file":"date-format.js","sources":["uni_modules/uni-dateformat/components/uni-dateformat/date-format.js"],"sourcesContent":["// yyyy-MM-dd hh:mm:ss.SSS 所有支持的类型\nfunction pad(str, length = 2) {\n\tstr += ''\n\twhile (str.length < length) {\n\t\tstr = '0' + str\n\t}\n\treturn str.slice(-length)\n}\n\nconst parser = {\n\tyyyy: (dateObj) => {\n\t\treturn pad(dateObj.year, 4)\n\t},\n\tyy: (dateObj) => {\n\t\treturn pad(dateObj.year)\n\t},\n\tMM: (dateObj) => {\n\t\treturn pad(dateObj.month)\n\t},\n\tM: (dateObj) => {\n\t\treturn dateObj.month\n\t},\n\tdd: (dateObj) => {\n\t\treturn pad(dateObj.day)\n\t},\n\td: (dateObj) => {\n\t\treturn dateObj.day\n\t},\n\thh: (dateObj) => {\n\t\treturn pad(dateObj.hour)\n\t},\n\th: (dateObj) => {\n\t\treturn dateObj.hour\n\t},\n\tmm: (dateObj) => {\n\t\treturn pad(dateObj.minute)\n\t},\n\tm: (dateObj) => {\n\t\treturn dateObj.minute\n\t},\n\tss: (dateObj) => {\n\t\treturn pad(dateObj.second)\n\t},\n\ts: (dateObj) => {\n\t\treturn dateObj.second\n\t},\n\tSSS: (dateObj) => {\n\t\treturn pad(dateObj.millisecond, 3)\n\t},\n\tS: (dateObj) => {\n\t\treturn dateObj.millisecond\n\t},\n}\n\n// 这都n年了iOS依然不认识2020-12-12，需要转换为2020/12/12\nfunction getDate(time) {\n\tif (time instanceof Date) {\n\t\treturn time\n\t}\n\tswitch (typeof time) {\n\t\tcase 'string':\n\t\t\t{\n\t\t\t\t// 2020-12-12T12:12:12.000Z、2020-12-12T12:12:12.000\n\t\t\t\tif (time.indexOf('T') > -1) {\n\t\t\t\t\treturn new Date(time)\n\t\t\t\t}\n\t\t\t\treturn new Date(time.replace(/-/g, '/'))\n\t\t\t}\n\t\tdefault:\n\t\t\treturn new Date(time)\n\t}\n}\n\nexport function formatDate(date, format = 'yyyy/MM/dd hh:mm:ss') {\n\tif (!date && date !== 0) {\n\t\treturn ''\n\t}\n\tdate = getDate(date)\n\tconst dateObj = {\n\t\tyear: date.getFullYear(),\n\t\tmonth: date.getMonth() + 1,\n\t\tday: date.getDate(),\n\t\thour: date.getHours(),\n\t\tminute: date.getMinutes(),\n\t\tsecond: date.getSeconds(),\n\t\tmillisecond: date.getMilliseconds()\n\t}\n\tconst tokenRegExp = /yyyy|yy|MM|M|dd|d|hh|h|mm|m|ss|s|SSS|SS|S/\n\tlet flag = true\n\tlet result = format\n\twhile (flag) {\n\t\tflag = false\n\t\tresult = result.replace(tokenRegExp, function(matched) {\n\t\t\tflag = true\n\t\t\treturn parser[matched](dateObj)\n\t\t})\n\t}\n\treturn result\n}\n\nexport function friendlyDate(time, {\n\tlocale = 'zh',\n\tthreshold = [60000, 3600000],\n\tformat = 'yyyy/MM/dd hh:mm:ss'\n}) {\n\tif (time === '-') {\n\t\treturn time\n\t}\n\tif (!time && time !== 0) {\n\t\treturn ''\n\t}\n\tconst localeText = {\n\t\tzh: {\n\t\t\tyear: '年',\n\t\t\tmonth: '月',\n\t\t\tday: '天',\n\t\t\thour: '小时',\n\t\t\tminute: '分钟',\n\t\t\tsecond: '秒',\n\t\t\tago: '前',\n\t\t\tlater: '后',\n\t\t\tjustNow: '刚刚',\n\t\t\tsoon: '马上',\n\t\t\ttemplate: '{num}{unit}{suffix}'\n\t\t},\n\t\ten: {\n\t\t\tyear: 'year',\n\t\t\tmonth: 'month',\n\t\t\tday: 'day',\n\t\t\thour: 'hour',\n\t\t\tminute: 'minute',\n\t\t\tsecond: 'second',\n\t\t\tago: 'ago',\n\t\t\tlater: 'later',\n\t\t\tjustNow: 'just now',\n\t\t\tsoon: 'soon',\n\t\t\ttemplate: '{num} {unit} {suffix}'\n\t\t}\n\t}\n\tconst text = localeText[locale] || localeText.zh\n\tlet date = getDate(time)\n\tlet ms = date.getTime() - Date.now()\n\tlet absMs = Math.abs(ms)\n\tif (absMs < threshold[0]) {\n\t\treturn ms < 0 ? text.justNow : text.soon\n\t}\n\tif (absMs >= threshold[1]) {\n\t\treturn formatDate(date, format)\n\t}\n\tlet num\n\tlet unit\n\tlet suffix = text.later\n\tif (ms < 0) {\n\t\tsuffix = text.ago\n\t\tms = -ms\n\t}\n\tconst seconds = Math.floor((ms) / 1000)\n\tconst minutes = Math.floor(seconds / 60)\n\tconst hours = Math.floor(minutes / 60)\n\tconst days = Math.floor(hours / 24)\n\tconst months = Math.floor(days / 30)\n\tconst years = Math.floor(months / 12)\n\tswitch (true) {\n\t\tcase years > 0:\n\t\t\tnum = years\n\t\t\tunit = text.year\n\t\t\tbreak\n\t\tcase months > 0:\n\t\t\tnum = months\n\t\t\tunit = text.month\n\t\t\tbreak\n\t\tcase days > 0:\n\t\t\tnum = days\n\t\t\tunit = text.day\n\t\t\tbreak\n\t\tcase hours > 0:\n\t\t\tnum = hours\n\t\t\tunit = text.hour\n\t\t\tbreak\n\t\tcase minutes > 0:\n\t\t\tnum = minutes\n\t\t\tunit = text.minute\n\t\t\tbreak\n\t\tdefault:\n\t\t\tnum = seconds\n\t\t\tunit = text.second\n\t\t\tbreak\n\t}\n\n\tif (locale === 'en') {\n\t\tif (num === 1) {\n\t\t\tnum = 'a'\n\t\t} else {\n\t\t\tunit += 's'\n\t\t}\n\t}\n\n\treturn text.template.replace(/{\\s*num\\s*}/g, num + '').replace(/{\\s*unit\\s*}/g, unit).replace(/{\\s*suffix\\s*}/g,\n\t\tsuffix)\n}\n"],"names":[],"mappings":";AACA,SAAS,IAAI,KAAK,SAAS,GAAG;AAC7B,SAAO;AACP,SAAO,IAAI,SAAS,QAAQ;AAC3B,UAAM,MAAM;AAAA,EACZ;AACD,SAAO,IAAI,MAAM,CAAC,MAAM;AACzB;AAEA,MAAM,SAAS;AAAA,EACd,MAAM,CAAC,YAAY;AAClB,WAAO,IAAI,QAAQ,MAAM,CAAC;AAAA,EAC1B;AAAA,EACD,IAAI,CAAC,YAAY;AAChB,WAAO,IAAI,QAAQ,IAAI;AAAA,EACvB;AAAA,EACD,IAAI,CAAC,YAAY;AAChB,WAAO,IAAI,QAAQ,KAAK;AAAA,EACxB;AAAA,EACD,GAAG,CAAC,YAAY;AACf,WAAO,QAAQ;AAAA,EACf;AAAA,EACD,IAAI,CAAC,YAAY;AAChB,WAAO,IAAI,QAAQ,GAAG;AAAA,EACtB;AAAA,EACD,GAAG,CAAC,YAAY;AACf,WAAO,QAAQ;AAAA,EACf;AAAA,EACD,IAAI,CAAC,YAAY;AAChB,WAAO,IAAI,QAAQ,IAAI;AAAA,EACvB;AAAA,EACD,GAAG,CAAC,YAAY;AACf,WAAO,QAAQ;AAAA,EACf;AAAA,EACD,IAAI,CAAC,YAAY;AAChB,WAAO,IAAI,QAAQ,MAAM;AAAA,EACzB;AAAA,EACD,GAAG,CAAC,YAAY;AACf,WAAO,QAAQ;AAAA,EACf;AAAA,EACD,IAAI,CAAC,YAAY;AAChB,WAAO,IAAI,QAAQ,MAAM;AAAA,EACzB;AAAA,EACD,GAAG,CAAC,YAAY;AACf,WAAO,QAAQ;AAAA,EACf;AAAA,EACD,KAAK,CAAC,YAAY;AACjB,WAAO,IAAI,QAAQ,aAAa,CAAC;AAAA,EACjC;AAAA,EACD,GAAG,CAAC,YAAY;AACf,WAAO,QAAQ;AAAA,EACf;AACF;AAGA,SAAS,QAAQ,MAAM;AACtB,MAAI,gBAAgB,MAAM;AACzB,WAAO;AAAA,EACP;AACD,UAAQ,OAAO,MAAI;AAAA,IAClB,KAAK,UACJ;AAEC,UAAI,KAAK,QAAQ,GAAG,IAAI,IAAI;AAC3B,eAAO,IAAI,KAAK,IAAI;AAAA,MACpB;AACD,aAAO,IAAI,KAAK,KAAK,QAAQ,MAAM,GAAG,CAAC;AAAA,IACvC;AAAA,IACF;AACC,aAAO,IAAI,KAAK,IAAI;AAAA,EACrB;AACF;AAEO,SAAS,WAAW,MAAM,SAAS,uBAAuB;AAChE,MAAI,CAAC,QAAQ,SAAS,GAAG;AACxB,WAAO;AAAA,EACP;AACD,SAAO,QAAQ,IAAI;AACnB,QAAM,UAAU;AAAA,IACf,MAAM,KAAK,YAAa;AAAA,IACxB,OAAO,KAAK,SAAQ,IAAK;AAAA,IACzB,KAAK,KAAK,QAAS;AAAA,IACnB,MAAM,KAAK,SAAU;AAAA,IACrB,QAAQ,KAAK,WAAY;AAAA,IACzB,QAAQ,KAAK,WAAY;AAAA,IACzB,aAAa,KAAK,gBAAiB;AAAA,EACnC;AACD,QAAM,cAAc;AACpB,MAAI,OAAO;AACX,MAAI,SAAS;AACb,SAAO,MAAM;AACZ,WAAO;AACP,aAAS,OAAO,QAAQ,aAAa,SAAS,SAAS;AACtD,aAAO;AACP,aAAO,OAAO,OAAO,EAAE,OAAO;AAAA,IACjC,CAAG;AAAA,EACD;AACD,SAAO;AACR;AAEO,SAAS,aAAa,MAAM;AAAA,EAClC,SAAS;AAAA,EACT,YAAY,CAAC,KAAO,IAAO;AAAA,EAC3B,SAAS;AACV,GAAG;AACF,MAAI,SAAS,KAAK;AACjB,WAAO;AAAA,EACP;AACD,MAAI,CAAC,QAAQ,SAAS,GAAG;AACxB,WAAO;AAAA,EACP;AACD,QAAM,aAAa;AAAA,IAClB,IAAI;AAAA,MACH,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,MACL,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,KAAK;AAAA,MACL,OAAO;AAAA,MACP,SAAS;AAAA,MACT,MAAM;AAAA,MACN,UAAU;AAAA,IACV;AAAA,IACD,IAAI;AAAA,MACH,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,MACL,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,KAAK;AAAA,MACL,OAAO;AAAA,MACP,SAAS;AAAA,MACT,MAAM;AAAA,MACN,UAAU;AAAA,IACV;AAAA,EACD;AACD,QAAM,OAAO,WAAW,MAAM,KAAK,WAAW;AAC9C,MAAI,OAAO,QAAQ,IAAI;AACvB,MAAI,KAAK,KAAK,QAAO,IAAK,KAAK,IAAK;AACpC,MAAI,QAAQ,KAAK,IAAI,EAAE;AACvB,MAAI,QAAQ,UAAU,CAAC,GAAG;AACzB,WAAO,KAAK,IAAI,KAAK,UAAU,KAAK;AAAA,EACpC;AACD,MAAI,SAAS,UAAU,CAAC,GAAG;AAC1B,WAAO,WAAW,MAAM,MAAM;AAAA,EAC9B;AACD,MAAI;AACJ,MAAI;AACJ,MAAI,SAAS,KAAK;AAClB,MAAI,KAAK,GAAG;AACX,aAAS,KAAK;AACd,SAAK,CAAC;AAAA,EACN;AACD,QAAM,UAAU,KAAK,MAAO,KAAM,GAAI;AACtC,QAAM,UAAU,KAAK,MAAM,UAAU,EAAE;AACvC,QAAM,QAAQ,KAAK,MAAM,UAAU,EAAE;AACrC,QAAM,OAAO,KAAK,MAAM,QAAQ,EAAE;AAClC,QAAM,SAAS,KAAK,MAAM,OAAO,EAAE;AACnC,QAAM,QAAQ,KAAK,MAAM,SAAS,EAAE;AACpC,UAAQ,MAAI;AAAA,IACX,KAAK,QAAQ;AACZ,YAAM;AACN,aAAO,KAAK;AACZ;AAAA,IACD,KAAK,SAAS;AACb,YAAM;AACN,aAAO,KAAK;AACZ;AAAA,IACD,KAAK,OAAO;AACX,YAAM;AACN,aAAO,KAAK;AACZ;AAAA,IACD,KAAK,QAAQ;AACZ,YAAM;AACN,aAAO,KAAK;AACZ;AAAA,IACD,KAAK,UAAU;AACd,YAAM;AACN,aAAO,KAAK;AACZ;AAAA,IACD;AACC,YAAM;AACN,aAAO,KAAK;AACZ;AAAA,EACD;AAED,MAAI,WAAW,MAAM;AACpB,QAAI,QAAQ,GAAG;AACd,YAAM;AAAA,IACT,OAAS;AACN,cAAQ;AAAA,IACR;AAAA,EACD;AAED,SAAO,KAAK,SAAS,QAAQ,gBAAgB,MAAM,EAAE,EAAE,QAAQ,iBAAiB,IAAI,EAAE;AAAA,IAAQ;AAAA,IAC7F;AAAA,EAAM;AACR;;"}