{"version":3,"file":"self.js","sources":["pages/self/self.vue","../前端资料/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2VsZi9zZWxmLnZ1ZQ"],"sourcesContent":["<!-- “我的”页面 -->\r\n<template>\n\t<view class=\"self\">\n\t\t<view :style=\"{height:getNavBarHeight()+'px'}\"></view>\n\t\t\t\t\t\t\n\t\t<view class=\"userinfo\">\n\t\t\t<view class=\"left\">\n\t\t\t\t<view class=\"avatar\">\r\n\t\t\t\t\t<!-- 头像 -->\n\t\t\t\t\t<image :src=\"userStore.userInfo.avatar || '../../static/images/defAvatar.png'\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\n\t\t\t\t</view>\n\t\t\t\t<view class=\"info\">\n\t\t\t\t\t<view class=\"username\">{{truncateString(userStore.userInfo.username,8)}}</view>\n\t\t\t\t\t<view class=\"text\">喝汤的第\n\t\t\t\t\t{{daysFromTimestamp(userStore.userInfo.register_date)}}\n\t\t\t\t\t天</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<navigator url=\"/pages_self/user/edit\" class=\"right\">\n\t\t\t\t<view class=\"text\">编辑资料</view>\n\t\t\t\t<view class=\"icon\">\n\t\t\t\t\t<uni-icons type=\"right\" size=\"20\" color=\"#999\"></uni-icons>\n\t\t\t\t</view>\n\t\t\t</navigator>\n\t\t</view>\n\t\n\t\t<view class=\"cardLayout\">\n\t\t\t<view class=\"list\">\t\t\t\t\n\t\t\t\t<navigator url=\"/pages_self/soup/list\" class=\"item\">\n\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t<view class=\"icon\" \n\t\t\t\t\t\tstyle=\"background-image: linear-gradient(to right,rgba(111,207,151,1),rgba(111,207,151,0.5))\">\n\t\t\t\t\t\t\t<uni-icons \n\t\t\t\t\t\t\tcustom-prefix=\"iconfont\" \n\t\t\t\t\t\t\ttype=\"xxm-highlight-fill\" size=\"18\" color=\"#fff\"></uni-icons>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"name\">熬制鸡汤</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t<view class=\"text\">{{dataset.soup}}</view>\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"18\" color=\"#999\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</navigator>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t<navigator url=\"/pages_self/reviewed/list\" class=\"item\" v-if=\"isAdminRole()\">\n\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t<view class=\"icon\" style=\"background-image: linear-gradient(to right,rgba(156,77,204,1),rgba(156,77,204,0.5))\">\n\t\t\t\t\t\t\t<uni-icons\n\t\t\t\t\t\t\tcustom-prefix=\"iconfont\" \n\t\t\t\t\t\t\ttype=\"xxm-edit-fill\" size=\"18\" color=\"#fff\"></uni-icons>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"name\">审核鸡汤</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t<view class=\"text\"></view>\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"18\" color=\"#999\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</navigator>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t<navigator url=\"/pages_self/like/list\" class=\"item\">\n\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t<view class=\"icon\"\n\t\t\t\t\t\tstyle=\"background-image: linear-gradient(to right,rgba(242,148,146,1),rgba(242,148,146,0.5));\"\n\t\t\t\t\t\t><uni-icons custom-prefix=\"iconfont\" type=\"xxm-heart-fill\" color=\"#fff\" size=\"18\"></uni-icons></view>\n\t\t\t\t\t\t<view class=\"name\">我的喜欢</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t<view class=\"text\">{{dataset.like}}</view>\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"18\" color=\"#999\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</navigator>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t<!-- 都是点击跳转 -->\n\t\t\t\t<navigator url=\"/pages_self/score/list\" class=\"item\">\n\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t<view class=\"icon\" style=\"background-image: linear-gradient(to right,rgba(75,228,197,1),rgba(75,228,197,0.5))\">\n\t\t\t\t\t\t\t<uni-icons\n\t\t\t\t\t\t\tcustom-prefix=\"iconfont\" \n\t\t\t\t\t\t\ttype=\"xxm-hourglass-fill\" size=\"18\" color=\"#fff\"></uni-icons>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"name\">我的积分</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t<view class=\"text\">{{dataset.scores}}分</view>\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"18\" color=\"#999\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</navigator>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t<navigator url=\"/pages_coop/index/index\" class=\"item\">\n\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t<view class=\"icon\" style=\"background-image: linear-gradient(to right,rgba(59,59,152,1),rgba(59,59,152,0.5))\">\n\t\t\t\t\t\t\t<uni-icons type=\"pyq\" color=\"#fff\" size=\"18\"></uni-icons>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"name\">鸡圈</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t<view class=\"text\">社区交流</view>\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"22\" color=\"#999\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</navigator>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t<view class=\"item\">\n\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t<view class=\"icon\" style=\"background-image: linear-gradient(to right,rgba(255,112,52,1),rgba(255,112,52,0.5))\">\n\t\t\t\t\t\t\t<uni-icons\n\t\t\t\t\t\t\tcustom-prefix=\"iconfont\" \n\t\t\t\t\t\t\ttype=\"xxm-message-fill\" size=\"18\" color=\"#fff\"></uni-icons>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"name\">联系我们</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t<view class=\"text\">在线客服</view>\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"22\" color=\"#999\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t\t<button open-type=\"contact\" class=\"contactBtn\" style=\"width: 100%;\">联系</button>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<view class=\"cardLayout\">\n\t\t\t<ad unit-id=\"adunit-3e2ae9dacbcb600d\" ad-type=\"video\" ad-theme=\"white\"></ad> \n\t\t</view>\n\t\t\n\t\t\n\t\t\n\t\t<!--  \n\t\t<view class=\"cardLayout\">\n\t\t\t<view class=\"list\">\n\t\t\t\t<view class=\"item\">\n\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t<view class=\"icon\" style=\"background-image: linear-gradient(to right,rgba(181,207,216,1),rgba(181,207,216,0.5))\">\n\t\t\t\t\t\t\t<uni-icons\n\t\t\t\t\t\t\tcustom-prefix=\"iconfont\" \n\t\t\t\t\t\t\ttype=\"xxm-pushpin-fill\" size=\"18\" color=\"#fff\"></uni-icons>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"name\">偏好设置</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t<view class=\"text\">默认</view>\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"22\" color=\"#999\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t<view class=\"item\">\n\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t<view class=\"icon\" style=\"background-image: linear-gradient(to right,rgba(181,207,216,1),rgba(181,207,216,0.5))\">\n\t\t\t\t\t\t\t<uni-icons\n\t\t\t\t\t\t\tcustom-prefix=\"iconfont\" \n\t\t\t\t\t\t\ttype=\"xxm-api-fill\" size=\"18\" color=\"#fff\"></uni-icons>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"name\">退出登录</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t<view class=\"text\"></view>\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"22\" color=\"#999\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t</view>\n\t\t</view>\n\t\t-->\n\t\t\n\t\t\n\t</view>\n</template>\n\n<script setup>\nimport {ref} from \"vue\";\nimport {getNavBarHeight} from \"@/utils/system.js\"\nimport {useCounterStore} from \"@/stores/counter.js\"\nimport {useUserStore} from \"@/stores/user.js\"\nimport {isAdminRole} from \"@/utils/common.js\"\nimport {daysFromTimestamp,truncateString} from \"@/utils/tools.js\"\nconst counterStore = useCounterStore();\nconst userStore = useUserStore();\nconst db = uniCloud.database();\nconst dataset = ref({\n\tsoup:0,\n\tlike:0,\n\tscores:0\n})\n\nconst getUserDataset = async()=>{\n\tlet soup = db.collection(\"soup-chicken\").where(`user_id == $cloudEnv_uid && status==1`).count();\n\tlet like = db.collection(\"soup-like\").where(`user_id == $cloudEnv_uid`).count();\n\tlet scores = db.collection(\"soup-scores\").where(`user_id ==  $cloudEnv_uid`).orderBy(\"create_date\",\"desc\").limit(1).get({getOne:true});\n\n\tPromise.all([soup,like,scores]).then(res=>{\n\t\tconsole.log(res);\n\t\tdataset.value.soup = res[0].result.total;\n\t\tdataset.value.like = res[1].result.total;\n\t\tdataset.value.scores = res[2].result?.data?.balance ?? 0;\n\t})\n\t  \n}\n\n\ngetUserDataset();\n\n</script>\n\n<style lang=\"scss\" scoped>\n.self{\n\tbackground: $page-bg-color;\n\tmin-height: 100vh;\n\tpadding-bottom:30rpx;\n\t.userinfo{\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding:50rpx;\n\t\t.left{\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\t.avatar{\n\t\t\t\twidth: 120rpx;\n\t\t\t\theight: 120rpx;\n\t\t\t\tborder:3px solid #fff;\n\t\t\t\tborder-radius: 50%;\n\t\t\t\toverflow: hidden;\n\t\t\t\timage{\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t}\n\t\t\t}\n\t\t\t.info{\n\t\t\t\tpadding-left:20rpx;\n\t\t\t\t.username{\n\t\t\t\t\tfont-size: 38rpx;\n\t\t\t\t\tfont-weight: 600;\n\t\t\t\t\tcolor:#111;\n\t\t\t\t}\n\t\t\t\t.text{\n\t\t\t\t\tfont-size: 26rpx;\n\t\t\t\t\tfont-weight: 100;\n\t\t\t\t\tcolor:$text-font-color-3;\n\t\t\t\t\tpadding-top:10rpx;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\t.right{\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\t.text{\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor:#999;\n\t\t\t}\n\t\t}\n\t}\n\n\t.cardLayout{\n\t\twidth: 690rpx;\n\t\tbackground: #fff;\n\t\tmargin:30rpx auto;\n\t\tborder-radius: 20rpx;\n\t\t.list{\n\t\t\tpadding:30rpx;\n\t\t\t.item{\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: space-between;\n\t\t\t\tpadding:34rpx 0;\n\t\t\t\tborder-bottom: 1px solid $border-color-light;\n\t\t\t\tposition: relative;\n\t\t\t\t&:last-child{\n\t\t\t\t\tborder:none;\n\t\t\t\t}\n\t\t\t\t.left{\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t.icon{\n\t\t\t\t\t\twidth: 50rpx;\n\t\t\t\t\t\theight: 50rpx;\n\t\t\t\t\t\tbackground: #fff;\n\t\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t}\n\t\t\t\t\t.name{\n\t\t\t\t\t\tfont-size: 38rpx;\n\t\t\t\t\t\tpadding-left:20rpx;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t.right{\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tfont-size: 26rpx;\n\t\t\t\t\tcolor:#999;\n\t\t\t\t}\n\t\t\t\t.contactBtn{\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop:0;\n\t\t\t\t\tleft:0;\n\t\t\t\t\topacity:0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n</style>\n","import MiniProgramPage from 'C:/Users/DELL/Desktop/chickensoup/pages/self/self.vue'\nwx.createPage(MiniProgramPage)"],"names":["useCounterStore","useUserStore","uniCloud","ref","uni"],"mappings":";;;;;;;;;;;;;;;;;;AA2LqBA,mBAAAA,gBAAkB;AACvC,UAAM,YAAYC,YAAY,aAAA;AAC9B,UAAM,KAAKC,cAAAA,GAAS;AACpB,UAAM,UAAUC,cAAAA,IAAI;AAAA,MACnB,MAAK;AAAA,MACL,MAAK;AAAA,MACL,QAAO;AAAA,IACR,CAAC;AAED,UAAM,iBAAiB,YAAS;AAC/B,UAAI,OAAO,GAAG,WAAW,cAAc,EAAE,MAAM,uCAAuC,EAAE;AACxF,UAAI,OAAO,GAAG,WAAW,WAAW,EAAE,MAAM,0BAA0B,EAAE;AACxE,UAAI,SAAS,GAAG,WAAW,aAAa,EAAE,MAAM,2BAA2B,EAAE,QAAQ,eAAc,MAAM,EAAE,MAAM,CAAC,EAAE,IAAI,EAAC,QAAO,KAAI,CAAC;AAErI,cAAQ,IAAI,CAAC,MAAK,MAAK,MAAM,CAAC,EAAE,KAAK,SAAK;;AACzCC,sBAAAA,MAAY,MAAA,OAAA,8BAAA,GAAG;AACf,gBAAQ,MAAM,OAAO,IAAI,CAAC,EAAE,OAAO;AACnC,gBAAQ,MAAM,OAAO,IAAI,CAAC,EAAE,OAAO;AACnC,gBAAQ,MAAM,WAAS,eAAI,CAAC,EAAE,WAAP,mBAAe,SAAf,mBAAqB,YAAW;AAAA,MACzD,CAAE;AAAA,IAEF;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClNA,GAAG,WAAW,eAAe;"}